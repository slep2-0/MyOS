\doxysection{hypermap.\+c}
\hypertarget{hypermap_8c_source}{}\label{hypermap_8c_source}\index{C:/Users/matanel/Desktop/Projects/KernelDevelopment/kernel/core/mm/hypermap.c@{C:/Users/matanel/Desktop/Projects/KernelDevelopment/kernel/core/mm/hypermap.c}}
\mbox{\hyperlink{hypermap_8c}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00001}00001\ \textcolor{comment}{/*++}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00002}00002\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00003}00003\ \textcolor{comment}{Module\ Name:}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00004}00004\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00005}00005\ \textcolor{comment}{\ \ \ \ hypermap.c}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00006}00006\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00007}00007\ \textcolor{comment}{Purpose:}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00008}00008\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00009}00009\ \textcolor{comment}{\ \ \ \ This\ translation\ unit\ contains\ the\ implementation\ of\ the\ temporary\ mapping\ functions.\ (hyperspace)/s}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00010}00010\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00011}00011\ \textcolor{comment}{Author:}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00012}00012\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00013}00013\ \textcolor{comment}{\ \ \ \ slep\ (Matanel)\ 2025.}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00014}00014\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00015}00015\ \textcolor{comment}{Revision\ History:}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00016}00016\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00017}00017\ \textcolor{comment}{-\/-\/*/}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00018}00018\ }
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00019}00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{mm_8h}{../../includes/mm.h}}"{}}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00020}00020\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{mh_8h}{../../includes/mh.h}}"{}}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00021}00021\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{assert_8h}{../../assert.h}}"{}}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00022}00022\ }
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00023}00023\ \textcolor{comment}{//\ The\ physical\ memory\ offset\ itself\ is\ the\ hypermap\ virtual\ address.\ This\ is\ ruled\ by\ not\ touching\ the\ 0x0\ -\/\ 0x1000\ physical\ addresses\ AT\ ALL\ (you\ may\ touch\ the\ physical\ addresses,\ but\ not\ map\ them\ with\ the\ PhysicalMemoryOffset\ virtual\ arithemtic.)}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00024}\mbox{\hyperlink{hypermap_8c_a9a030194aa32a92a3504947a77e44945}{00024}}\ \textcolor{preprocessor}{\#define\ HYPERMAP\_VIRTUAL\_ADDRESS\ PhysicalMemoryOffset}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00025}00025\ }
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00026}\mbox{\hyperlink{hypermap_8c_addf2d8238e04aeae15f172f732d57bbd}{00026}}\ \mbox{\hyperlink{ms_8h_adf17fb77fea5ef3f703733414efda5c4}{SPINLOCK}}\ \mbox{\hyperlink{hypermap_8c_addf2d8238e04aeae15f172f732d57bbd}{HyperLock}};}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00027}\mbox{\hyperlink{hypermap_8c_a1564f5593aaf0b20562692940b28ac3e}{00027}}\ \mbox{\hyperlink{mm_8h_add4af0c873a7e9aa078742eac12b1879}{PPFN\_ENTRY}}\ \mbox{\hyperlink{hypermap_8c_a1564f5593aaf0b20562692940b28ac3e}{g\_pfnInUse}};}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00028}00028\ }
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00029}\mbox{\hyperlink{hypermap_8c_a979672ff6f9bf90141b67720b4af82de}{00029}}\ \textcolor{preprocessor}{\#define\ LOCK\_HYPERSPACE(PtrOldIrql)\ MsAcquireSpinlock(\&HyperLock,\ PtrOldIrql)}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00030}\mbox{\hyperlink{hypermap_8c_aee90cdec2325a1b7f647ac1af3de003d}{00030}}\ \textcolor{preprocessor}{\#define\ UNLOCK\_HYPERSPACE(OldIrql)\ MsReleaseSpinlock(\&HyperLock,\ OldIrql)}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00031}00031\ }
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00032}00032\ \textcolor{keywordtype}{void}*}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00033}\mbox{\hyperlink{hypermap_8c_a9e3de9aacb781db1acf2815ec071f30e}{00033}}\ \mbox{\hyperlink{hypermap_8c_a9e3de9aacb781db1acf2815ec071f30e}{MiMapPageInHyperspace}}(}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00034}00034\ \ \ \ \ \mbox{\hyperlink{annotations_8h_ac2bbd6d630a06a980d9a92ddb9a49928}{IN}}\ \ uint64\_t\ PfnIndex,}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00035}00035\ \ \ \ \ \mbox{\hyperlink{annotations_8h_aec78e7a9e90a406a56f859ee456e8eae}{OUT}}\ \ \mbox{\hyperlink{core_8h_a759f4aeab4719639765f2160de0116da}{PIRQL}}\ OldIrql}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00036}00036\ )}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00037}00037\ }
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00038}00038\ \textcolor{comment}{/*++}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00039}00039\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00040}00040\ \textcolor{comment}{\ \ \ \ Routine\ description:}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00041}00041\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00042}00042\ \textcolor{comment}{\ \ \ \ \ \ \ \ Temporary\ maps\ the\ specified\ PFN\ Page\ into\ hyperspace\ and\ returns\ the\ virtual\ address\ mapped\ into.}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00043}00043\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00044}00044\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ ************************************}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00045}00045\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ *\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00046}00046\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ *\ Returns\ with\ a\ spin\ lock\ held!!!\ *\ //\ thanks\ lou}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00047}00047\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ *\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ *}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00048}00048\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ ************************************}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00049}00049\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00050}00050\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00051}00051\ \textcolor{comment}{\ \ \ \ Arguments:}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00052}00052\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00053}00053\ \textcolor{comment}{\ \ \ \ \ \ \ \ [IN]\ \ \ \ PfnIndex\ -\/\ Page\ frame\ index\ to\ map.}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00054}00054\ \textcolor{comment}{\ \ \ \ \ \ \ \ [OUT]\ \ \ \ OldIrql\ -\/\ Pointer\ to\ store\ entry\ IRQL.}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00055}00055\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00056}00056\ \textcolor{comment}{\ \ \ \ Return\ Values:}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00057}00057\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00058}00058\ \textcolor{comment}{\ \ \ \ \ \ \ \ Valid\ Pointer\ to\ mapped\ region.}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00059}00059\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00060}00060\ \textcolor{comment}{-\/-\/*/}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00061}00061\ }
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00062}00062\ \{}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00063}00063\ \ \ \ \ \textcolor{comment}{//\ First,\ lock\ the\ hyperspace.}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00064}00064\ \ \ \ \ \mbox{\hyperlink{hypermap_8c_a979672ff6f9bf90141b67720b4af82de}{LOCK\_HYPERSPACE}}\ (OldIrql);}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00065}00065\ }
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00066}00066\ \ \ \ \ \textcolor{comment}{//\ Map\ the\ PFN\ into\ the\ page.}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00067}00067\ \ \ \ \ \mbox{\hyperlink{mm_8h_add4af0c873a7e9aa078742eac12b1879}{PPFN\_ENTRY}}\ pfn\ =\ \mbox{\hyperlink{mm_8h_ad9b99c6be796a28588cd102246ddba8c}{INDEX\_TO\_PPFN}}\ (PfnIndex);}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00068}00068\ \ \ \ \ uint64\_t\ physAddr\ =\ \mbox{\hyperlink{mm_8h_a78991932775ada0acbd8c80e96757954}{PPFN\_TO\_PHYSICAL\_ADDRESS}}\ (pfn);}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00069}00069\ \ \ \ \ \mbox{\hyperlink{mm_8h_a58b57de8cb1ef44a0f90f7f6e82f4b17}{PMMPTE}}\ pte\ =\ \mbox{\hyperlink{map_8c_ae02125d7ba25e59d4034251153f86492}{MiGetPtePointer}}(\mbox{\hyperlink{hypermap_8c_a9a030194aa32a92a3504947a77e44945}{HYPERMAP\_VIRTUAL\_ADDRESS}});}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00070}00070\ \ \ \ \ \mbox{\hyperlink{mm_8h_adc67d797a4f0738b7e8b651af8bdfd71}{MI\_WRITE\_PTE}}(pte,\ \mbox{\hyperlink{hypermap_8c_a9a030194aa32a92a3504947a77e44945}{HYPERMAP\_VIRTUAL\_ADDRESS}},\ physAddr,\ \mbox{\hyperlink{mm_8h_a00a91f63329e5c0511b76df1ce7884b0ac5ccf22183fd81d4268d6eb4f3bad604}{PAGE\_PRESENT}}\ |\ \mbox{\hyperlink{mm_8h_a00a91f63329e5c0511b76df1ce7884b0a0e92aa1b5476d7f05fbdf6fe3acfeed6}{PAGE\_RW}});}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00071}00071\ }
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00072}00072\ \ \ \ \ \textcolor{comment}{//\ Set\ PFN\ metadata.}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00073}00073\ \ \ \ \ pfn-\/>\mbox{\hyperlink{struct___p_f_n___e_n_t_r_y_a9ac4c1f881137da2601ed5d333bb5989}{State}}\ =\ \mbox{\hyperlink{mm_8h_a12462d873d8d81a717b5a7622091e998a68c66f57633f47bedf7267c068ad1fc9}{PfnStateActive}};}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00074}00074\ \ \ \ \ pfn-\/>\mbox{\hyperlink{struct___p_f_n___e_n_t_r_y_a118ffbb89a3a201c17eae8d00f9e70d7}{Descriptor}}.\mbox{\hyperlink{struct___p_f_n___e_n_t_r_y_a968216918d5ebf946c497a66564f1223}{Mapping}}.\mbox{\hyperlink{struct___p_f_n___e_n_t_r_y_aaf1a5e1a132630fb917e3fc578d379cb}{PteAddress}}\ =\ pte;}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00075}00075\ \ \ \ \ pfn-\/>\mbox{\hyperlink{struct___p_f_n___e_n_t_r_y_a118ffbb89a3a201c17eae8d00f9e70d7}{Descriptor}}.\mbox{\hyperlink{struct___p_f_n___e_n_t_r_y_a968216918d5ebf946c497a66564f1223}{Mapping}}.\mbox{\hyperlink{struct___p_f_n___e_n_t_r_y_adb8c0f630bc7f4792c1489a7e8897e5b}{Vad}}\ =\ NULL;}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00076}00076\ \ \ \ \ \mbox{\hyperlink{hypermap_8c_a1564f5593aaf0b20562692940b28ac3e}{g\_pfnInUse}}\ =\ pfn;}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00077}00077\ }
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00078}00078\ \ \ \ \ \textcolor{comment}{//\ Return\ the\ virtual\ address\ (now\ mapped)}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00079}00079\ \ \ \ \ \textcolor{keywordflow}{return}\ (\textcolor{keywordtype}{void}*)\mbox{\hyperlink{hypermap_8c_a9a030194aa32a92a3504947a77e44945}{HYPERMAP\_VIRTUAL\_ADDRESS}};}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00080}00080\ \}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00081}00081\ }
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00082}00082\ \textcolor{keywordtype}{void}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00083}\mbox{\hyperlink{hypermap_8c_ad57ae3b2e037c15c00dfe55b252e7fc8}{00083}}\ \mbox{\hyperlink{hypermap_8c_ad57ae3b2e037c15c00dfe55b252e7fc8}{MiUnmapHyperSpaceMap}}(}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00084}00084\ \ \ \ \ \mbox{\hyperlink{annotations_8h_ac2bbd6d630a06a980d9a92ddb9a49928}{IN}}\ \ \mbox{\hyperlink{core_8h_a7258ea91cea6c1c174df48f6225ef4da}{IRQL}}\ OldIrql}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00085}00085\ )}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00086}00086\ }
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00087}00087\ \textcolor{comment}{/*++}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00088}00088\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00089}00089\ \textcolor{comment}{\ \ \ \ Routine\ description:}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00090}00090\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00091}00091\ \textcolor{comment}{\ \ \ \ \ \ \ \ Unlocks\ the\ hyperspace,\ clears\ previous\ mapping.}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00092}00092\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00093}00093\ \textcolor{comment}{\ \ \ \ Arguments:}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00094}00094\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00095}00095\ \textcolor{comment}{\ \ \ \ \ \ \ \ [IN]\ \ \ \ OldIrql\ -\/\ Entry\ IRQL\ given\ by\ MiMapPageInHyperspace}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00096}00096\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00097}00097\ \textcolor{comment}{\ \ \ \ Return\ Values:}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00098}00098\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00099}00099\ \textcolor{comment}{\ \ \ \ \ \ \ \ None.}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00100}00100\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00101}00101\ \textcolor{comment}{\ \ \ \ Notes:}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00102}00102\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00103}00103\ \textcolor{comment}{\ \ \ \ \ \ \ \ Does\ not\ release\ the\ PFN\ that\ was\ given,\ caller\ must\ do\ so.}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00104}00104\ \textcolor{comment}{}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00105}00105\ \textcolor{comment}{-\/-\/*/}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00106}00106\ }
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00107}00107\ \{}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00108}00108\ \ \ \ \ \textcolor{comment}{//\ Assertion\ that\ the\ hyperspace\ lock\ must\ be\ locked\ already\ (double\ unlock\ catch)}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00109}00109\ \ \ \ \ \mbox{\hyperlink{assert_8h_a3d4ae9c092e117c836f52dc7d7cee574}{assert}}((\mbox{\hyperlink{hypermap_8c_addf2d8238e04aeae15f172f732d57bbd}{HyperLock}}.locked)\ ==\ 1,\ \textcolor{stringliteral}{"{}Double\ hypermap\ unlock"{}});}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00110}00110\ \ \ \ \ \mbox{\hyperlink{assert_8h_a3d4ae9c092e117c836f52dc7d7cee574}{assert}}((\mbox{\hyperlink{hypermap_8c_a1564f5593aaf0b20562692940b28ac3e}{g\_pfnInUse}})\ !=\ 0,\ \textcolor{stringliteral}{"{}No\ PFN\ when\ releasing\ hyperspace."{}});}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00111}00111\ \ \ \ \ \mbox{\hyperlink{mm_8h_add4af0c873a7e9aa078742eac12b1879}{PPFN\_ENTRY}}\ pfn\ =\ \mbox{\hyperlink{hypermap_8c_a1564f5593aaf0b20562692940b28ac3e}{g\_pfnInUse}};}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00112}00112\ \ \ \ \ \textcolor{comment}{//\ Clear\ the\ PTE\ present\ bit\ (to\ prevent\ use\ after\ free)}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00113}00113\ \ \ \ \ \mbox{\hyperlink{map_8c_ae3021d571acb9a636398898e79e539be}{MiUnmapPte}}(\mbox{\hyperlink{map_8c_ae02125d7ba25e59d4034251153f86492}{MiGetPtePointer}}((uintptr\_t)\mbox{\hyperlink{hypermap_8c_a9a030194aa32a92a3504947a77e44945}{HYPERMAP\_VIRTUAL\_ADDRESS}}));}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00114}00114\ \ \ \ \ }
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00115}00115\ \ \ \ \ \textcolor{comment}{//\ After\ MiUnmapPte\ changed\ the\ pfn\ metadata,\ we\ change\ it\ once\ again\ to\ invalidate\ it.}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00116}00116\ \ \ \ \ pfn-\/>\mbox{\hyperlink{struct___p_f_n___e_n_t_r_y_a118ffbb89a3a201c17eae8d00f9e70d7}{Descriptor}}.\mbox{\hyperlink{struct___p_f_n___e_n_t_r_y_a968216918d5ebf946c497a66564f1223}{Mapping}}.\mbox{\hyperlink{struct___p_f_n___e_n_t_r_y_aaf1a5e1a132630fb917e3fc578d379cb}{PteAddress}}\ =\ NULL;}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00117}00117\ \ \ \ \ pfn-\/>\mbox{\hyperlink{struct___p_f_n___e_n_t_r_y_a118ffbb89a3a201c17eae8d00f9e70d7}{Descriptor}}.\mbox{\hyperlink{struct___p_f_n___e_n_t_r_y_a968216918d5ebf946c497a66564f1223}{Mapping}}.\mbox{\hyperlink{struct___p_f_n___e_n_t_r_y_adb8c0f630bc7f4792c1489a7e8897e5b}{Vad}}\ =\ NULL;}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00118}00118\ \ \ \ \ pfn-\/>\mbox{\hyperlink{struct___p_f_n___e_n_t_r_y_a9ac4c1f881137da2601ed5d333bb5989}{State}}\ =\ \mbox{\hyperlink{mm_8h_a12462d873d8d81a717b5a7622091e998a16c1fda3836f3c9b73b714d62f4dc311}{PfnStateTransition}};}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00119}00119\ \ \ \ \ \mbox{\hyperlink{hypermap_8c_a1564f5593aaf0b20562692940b28ac3e}{g\_pfnInUse}}\ =\ NULL;}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00120}00120\ }
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00121}00121\ \ \ \ \ \textcolor{comment}{//\ We\ do\ not\ release\ the\ PFN,\ caller\ must\ do\ so,\ because\ it\ might\ have\ other\ uses\ with\ it.}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00122}00122\ }
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00123}00123\ \ \ \ \ \textcolor{comment}{//\ Unlock\ the\ hyperspace.}}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00124}00124\ \ \ \ \ \mbox{\hyperlink{hypermap_8c_aee90cdec2325a1b7f647ac1af3de003d}{UNLOCK\_HYPERSPACE}}\ (OldIrql);}
\DoxyCodeLine{\Hypertarget{hypermap_8c_source_l00125}00125\ \}}

\end{DoxyCode}
